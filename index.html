<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>F√ºr dich ‚ù§Ô∏è</title>

<style>
:root{
  --bg:#05060b;
  --gold:rgba(255,220,150,.95);
  --pink: #e64a8d;
  --txt:#ffffff;
}
*{box-sizing:border-box}

body{
  margin:0;
  min-height:100vh;
  display:grid;
  place-items:center;
  background:var(--bg);
  color:var(--txt);
  font-family:-apple-system, system-ui, Segoe UI, Roboto, Arial;
  overflow:hidden;
}

/* ‚ùÑÔ∏è SNOW */
canvas{
  position:fixed;
  inset:0;
  pointer-events:none;
}
#snow{z-index:1}

/* ‚ú® MAGIC BACKGROUND */
.magic-bg{
  position:fixed;
  inset:-30%;
  opacity:0;
  pointer-events:none;
  transition:opacity 1.2s ease;
  z-index:2;
}
.magic-bg.active{opacity:1}

.magicGlow{
  position:absolute;
  inset:0;
  background:
    radial-gradient(circle at 30% 30%, rgba(255,220,150,.25), transparent 40%),
    radial-gradient(circle at 70% 40%, rgba(255,255,255,.18), transparent 45%),
    radial-gradient(circle at 50% 75%, rgba(230,90,140,.22), transparent 55%);
  animation:breathe 7s ease-in-out infinite;
}
@keyframes breathe{
  0%,100%{transform:scale(1);opacity:.85}
  50%{transform:scale(1.15);opacity:1}
}

/* üì¶ CONTENT */
.wrap{
  width:min(860px,92vw);
  padding:18px;
  position:relative;
  z-index:3;
}
.card{
  background:linear-gradient(180deg, rgba(255,255,255,.14), rgba(255,255,255,.06));
  border-radius:28px;
  padding:32px 26px;
  text-align:center;
  backdrop-filter:blur(16px);
  box-shadow:0 40px 140px rgba(0,0,0,.75);
}

h1{margin:0 0 12px;font-size:30px}
p{margin:10px 0;opacity:.95;line-height:1.5}

.btn{
  padding:16px 22px;
  border-radius:18px;
  border:none;
  cursor:pointer;
  font-size:17px;
  font-weight:800;
  background:linear-gradient(180deg,#fff,#eee);
  color:#111;
  position: relative;
  z-index: 10;
}

.stage{
  display:grid;
  place-items:center;
  min-height:230px;
  margin:26px 0;
}
.status{
  margin-top:14px;
  font-size:14px;
  opacity:.85;
}

/* üéÅ GIFT */
.gift-wrap{
  position:relative;
  display: flex;
  justify-content: center;
  align-items: center;
}
.gift{
  width:120px;
  height:100px;
  position:relative;
  animation:float 3.2s ease-in-out infinite;
  transform-style: preserve-3d;
}
@keyframes float{
  0%,100%{transform:translateY(0)}
  50%{transform:translateY(-12px)}
}

/* BOX BASE */
.box{
  position:absolute;
  bottom:0;
  width:100%;
  height:70%;
  background:white;
  border-radius:0 0 12px 12px;
  z-index: 4;
}

/* LID */
.lid{
  position:absolute;
  top:0;
  width:110%;
  left: -5%;
  height:35%;
  background:white;
  border-radius:10px;
  z-index: 6;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  transform-origin: bottom left;
  transition: transform 1s cubic-bezier(.2,.9,.2,1);
}

.open .lid{
  transform: rotate(-70deg) translate(-20px, -30px);
}

/* üéÄ RIBBONS (Shared Styles) */
.ribbon-v, .ribbon-h {
  position: absolute;
  background: var(--pink);
  z-index: 7;
}
.ribbon-v {
  width: 20px;
  height: 100%;
  left: 50%;
  transform: translateX(-50%);
}
.ribbon-h {
  width: 100%;
  height: 15px;
  top: 50%;
  transform: translateY(-50%);
}

/* ‚ú® INNER GLOW (The light inside) */
.inner-glow{
  position:absolute;
  left:10%;
  right:10%;
  top:20%;
  height:60px;
  background: radial-gradient(circle, #fff5d2 0%, #ffdc96 50%, transparent 80%);
  opacity:0;
  filter: blur(15px);
  z-index: 5; /* Between box and lid */
  transition: opacity 0.5s;
}

.open .inner-glow{
  opacity: 1;
  animation: pulseGlow 2s ease-in-out infinite alternate;
}

@keyframes pulseGlow {
  from { transform: scale(1); opacity: 0.6; }
  to { transform: scale(1.3); opacity: 1; }
}

/* üí• FLASH */
.flash{
  position:absolute;
  inset:-50px;
  background: radial-gradient(circle, rgba(255,240,200,1) 0%, transparent 70%);
  opacity:0;
  z-index: 8;
  pointer-events: none;
}
.open .flash{
  animation: flashAnim 0.8s ease-out forwards;
}
@keyframes flashAnim{
  0%{opacity:0; transform:scale(0.1);}
  50%{opacity:1;}
  100%{opacity:0; transform:scale(2.5);}
}

/* üìú REVEAL SECTION */
.section{
  opacity:0;
  transform:translateY(18px);
  transition:all 1.1s ease;
}
.section.show{opacity:1;transform:none}

.gifts{
  display:grid;
  gap:16px;
  margin-top:20px;
  text-align:left;
}
.giftItem{
  background:rgba(0,0,0,.28);
  padding:18px;
  border-radius:20px;
}
.small{margin-top:18px;font-size:14px;opacity:.85}

/* MAGIC RING */
.magic-ring{
  --ring-speed: 6s;
  --inset-min: -40px;
  --inset-max: -55px;
  --ring-width: 2.5px;
  border: var(--ring-width) solid rgba(255,220,150,.7);
  position:absolute;
  inset: var(--inset-min);
  border-radius:50%;
  opacity:0;
  pointer-events:none;
}
.magic-ring.active{ opacity:1; animation: ringRotate var(--ring-speed) linear infinite, ringPulse 2.8s ease-in-out infinite; }
.magic-ring.finale{ animation: ringFinale 0.9s ease-out forwards; }

@keyframes ringRotate{ from{transform:rotate(0deg)} to{transform:rotate(360deg)} }
@keyframes ringPulse{ 0%,100%{ inset: var(--inset-min); } 50%{ inset: var(--inset-max); } }
@keyframes ringFinale{
  0%{ inset: var(--inset-max); opacity: 1; border-width: var(--ring-width); }
  100%{ inset: -150px; opacity: 0; border-width: 1px; }
}
</style>
</head>

<body>

<canvas id="snow"></canvas>

<div class="magic-bg" id="magicBg">
  <div class="magicGlow"></div>
</div>

<div class="wrap">
<div class="card">

<h1>Frohe Weihnachten, mein Schatz ‚ù§Ô∏è</h1>
<p>Ich wollte dir dieses Jahr etwas schenken,<br>das Zeit bedeutet. Zeit f√ºr uns.</p>

<div class="stage">
  <div class="gift-wrap">
    <div class="magic-ring" id="magicRing"></div>
    
    <div class="gift" id="gift">
      <div class="flash"></div>
      
      <div class="lid">
        <div class="ribbon-v"></div>
        <div class="ribbon-h"></div>
      </div>

      <div class="inner-glow"></div>

      <div class="box">
        <div class="ribbon-v"></div>
      </div>
    </div>
  </div>

  <button class="btn" id="startBtn">üéÅ Geschenk √∂ffnen</button>
  <div class="status" id="status">Tippe, um die Magie zu entfesseln.</div>
</div>

<div class="section" id="reveal">
  <div class="gifts">
    <div class="giftItem"><strong>üé≠ Theater oder Musical</strong><br>Du darfst aussuchen welches ‚Äì und wir machen daraus unseren Abend (evtl. mit √úbernachtung üòâ).</div>
    <div class="giftItem"><strong>üé∏ Deine Gitarre</strong><br>Neu gestimmt, neue Saiten ‚Äì und wenn du willst: richtig sch√∂n machen lassen, damit du wieder Lust hast zu spielen.</div>
  </div>
  <p class="small">Ich liebe dich. ‚ù§Ô∏è</p>
</div>

<audio id="music" preload="auto">
  <source src="music.mp3" type="audio/mpeg">
</audio>

</div>
</div>

<script>
const REVEAL_AT = 25.263;
const btn = document.getElementById('startBtn');
const music = document.getElementById('music');
const status = document.getElementById('status');
const gift = document.getElementById('gift');
const reveal = document.getElementById('reveal');
const magicBg = document.getElementById('magicBg');
const magicRing = document.getElementById('magicRing');

/* SNOW LOGIC */
const snowC = document.getElementById('snow');
const sCtx = snowC.getContext('2d');
let w,h,snow;
function resize(){
  w = snowC.width = innerWidth * devicePixelRatio;
  h = snowC.height = innerHeight * devicePixelRatio;
  snow = Array.from({length:160},()=>({
    x:Math.random()*w,y:Math.random()*h,
    r:(Math.random()*2+1)*devicePixelRatio,
    s:(Math.random()*.6+.3)*devicePixelRatio
  }));
}
addEventListener('resize',resize);resize();
function snowDraw(){
  sCtx.clearRect(0,0,w,h);
  sCtx.fillStyle="rgba(255,255,255,.85)";
  snow.forEach(f=>{
    sCtx.beginPath(); sCtx.arc(f.x,f.y,f.r,0,Math.PI*2); sCtx.fill();
    f.y+=f.s; if(f.y>h){f.y=-10;f.x=Math.random()*w;}
  });
  requestAnimationFrame(snowDraw);
}
snowDraw();

/* MAIN LOGIC */
let started=false;
function tick(){
  if(!started) return;
  const t = music.currentTime || 0;
  if(t < REVEAL_AT){
    status.textContent = `‚ú® Magie entsteht‚Ä¶ (s)`;
    const p = Math.max(0, Math.min(1, t / REVEAL_AT));
    const speed = 6 - (4.8 * (p * p));
    magicRing.style.setProperty('--ring-speed', `s`);
    magicRing.style.setProperty('--inset-min', `${-40 - (20*p)}px`);
    magicRing.style.setProperty('--inset-max', `${-55 - (30*p)}px`);
    magicRing.style.setProperty('--ring-width', `px`);
  } else {
    magicBg.classList.remove('active');
    magicRing.classList.remove('active');
    magicRing.classList.add('finale');
    gift.classList.add('open');
    reveal.classList.add('show');
    status.textContent="üéÅ √úberraschung ge√∂ffnet";
  }
  requestAnimationFrame(tick);
}

btn.addEventListener('click', async ()=>{
  if(started) return;
  started = true;
  btn.style.display="none";
  magicBg.classList.add('active');
  magicRing.classList.add('active');
  try { await music.play(); } catch (e) { console.warn(e); }
  requestAnimationFrame(tick);
});
</script>
</body>
</html>
